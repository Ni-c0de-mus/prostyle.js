/*!
 * @license: MIT License - See https://github.com/GaryChamberlain/pro-motion-item-simpleBarChart/LICENSE
 * @author: Gary Chamberlain, gary@pro.graphics.
 **/

var __extends=this.__extends||function(d,b){function k(){this.constructor=d}for(var f in b)b.hasOwnProperty(f)&&(d[f]=b[f]);k.prototype=b.prototype;d.prototype=new k},Pro;
(function(d){(function(b){(function(k){(function(f){(function(f){var e=function(d){function c(a,u,c,e,g,b){d.call(this,a,u,c,g,e,b)}__extends(c,d);c.prototype.scrubValue=function(a){var c=[];if("number"===typeof a)return[[void 0,a]];"string"===typeof a?a.split(",").forEach(function(a){c.push([0,b.Util.convertToNumber(a.trim())])}):a instanceof Array&&a.forEach(function(a){a instanceof Array?c.push([0<a.length?b.Util.convertToNumber(a[0]):0,1<a.length?b.Util.convertToNumber(a[1]):0]):c.push([0,b.Util.convertToNumber(a)])});
return c};c.prototype.writeCssBucket=function(a,c,d,e,g){a=e.element.proCache||{};e.element.proCache=a;e=e.elementIndex;a=a.data=[0,0];g.length>e&&(g=g[e],0<g.length&&(a[0]=g[0]),1<g.length&&(a[1]=g[1]))};return c}(d.Motion.Models.Properties.Variables.VariableType);f.BarDataVariableType=e})(f.simpleBarChart||(f.simpleBarChart={}))})(k.Items||(k.Items={}))})(b.Extensions||(b.Extensions={}))})(d.Motion||(d.Motion={}))})(Pro||(Pro={}));
(function(d){(function(b){(function(b){(function(b){(function(b){var e=d.Motion.Models.Properties,f=function(c){function a(){var a=[];a.push(new b.BarDataVariableType("values",["values"],"dummy",[],"",!0));c.call(this,"data",["data"],a)}__extends(a,c);a.prototype.createPropertyFromBoolean=function(a){return c.prototype.createPropertyFromBoolean.call(this,!1)};a.prototype.createProperty=function(a){var c=new e.Property(this);c.values.setValue(a);return c};a.prototype.createPropertyFromNumber=function(a){return this.createProperty(a)};
a.prototype.createPropertyFromString=function(a){return this.createProperty(a)};a.prototype.createPropertyFromArray=function(a){return this.createProperty(a)};a.prototype.renderLabel=function(a){return this.renderVariables(a,!1,!0)};return a}(e.PropertyType);b.BarDataPropertyType=f})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(b.Extensions||(b.Extensions={}))})(d.Motion||(d.Motion={}))})(Pro||(Pro={}));
(function(d){(function(b){(function(b){(function(b){(function(b){var e=function(b){function c(a,c,e,d,g,l,f,h,k,t,q){b.call(this,a,"simpleBarChart","SimpleBarChart",[h],[k]);this.bars=c;this.width=e;this.height=d;this.margin=g;this.minDomainValue=l;this.maxDomainValue=f;this.barsInit=t;this.barsScriptSet=q}__extends(c,b);return c}(d.Motion.Models.Items.Item);b.Extension=e})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(b.Extensions||(b.Extensions={}))})(d.Motion||(d.Motion={}))})(Pro||
(Pro={}));
(function(d){(function(b){(function(b){(function(b){(function(b){var e=d.Motion.Models.Properties,f=function(){function c(){}c.cacheProperties=function(){c._propertyTypes=[];c._barPropertyTypes=[];var a=c._propertyTypes;a.push(e.Cache.ANIMATION);a.push(e.Cache.CROP_SVG);a.push(e.Cache.OPACITY);a.push(e.Cache.POSITION);a.push(e.Cache.ROTATION);a.push(e.Cache.SCALE);a.push(e.Cache.SKEW);a=c._barPropertyTypes;a.push(e.Cache.ANIMATION);a.push(new e.SvgFillPropertyType("rgba(0,0,0,0.5)"));a.push(e.Cache.OPACITY);a.push(e.Cache.SKEW);
a.push(new b.BarDataPropertyType)};c.getPropertyTypes=function(){void 0===c._propertyTypes&&c.cacheProperties();return c._propertyTypes};c.getBarPropertyTypes=function(){void 0===c._barPropertyTypes&&c.cacheProperties();return c._barPropertyTypes};c._propertyTypes=void 0;c._barPropertyTypes=void 0;return c}();b.Props=f})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(b.Extensions||(b.Extensions={}))})(d.Motion||(d.Motion={}))})(Pro||(Pro={}));
(function(d){(function(b){(function(b){(function(b){(function(b){var e=d.Motion.Util,f=function(b){function a(a,d){b.call(this,a,d,e.createChildSvgElement(d.div,"svg",{"class":"pro"}));this.simpleBarChartItem=a;this.barDivs=[];this.rangeBase=this.domainBase=this.domain=this.minDomain=this.maxDomain=this.barWidth=this.margin=this.height=this.width=0;this.g=e.createChildSvgElement(this.element,"g");for(var f=0;f<a.bars;f++)this.barDivs.push(e.createChildSvgElement(this.g,"rect"));this.maxDomain=a.maxDomainValue;
this.minDomain=a.minDomainValue;this.domain=Math.abs(this.maxDomain-this.minDomain);this.domainBase=0>this.maxDomain?this.maxDomain:0<this.minDomain?this.minDomain:0}__extends(a,b);a.prototype.initializeItem=function(a,b){var c=this.simpleBarChartItem,e=c.itemSet.flow.story,d=b.getContainedSize(c.itemSet.flow.pageAspectRatio);this.width=c.width/100*d.width;this.height=c.height/100*d.height;this.margin=this.simpleBarChartItem.margin/100*this.width;this.margin*(this.simpleBarChartItem.bars+1)>this.width?
this.margin=this.width/(this.simpleBarChartItem.bars+1):this.barWidth=(this.width-this.margin*this.simpleBarChartItem.bars)/this.simpleBarChartItem.bars;this.rangeBase=Math.abs(this.simpleBarChartItem.maxDomainValue-this.domainBase)/this.domain*this.height;var f={width:this.width,height:this.height};this.initializeProperties(e,[this.element],d,a,c.init,!0,f);f={};this.initializeProperties(e,this.barDivs,d,a,c.barsInit,!1,f,this.afterBarCssProperties.bind(this))};a.prototype.generateStepActions=function(a,
b,c,d,e){var f=this.simpleBarChartItem;this.generateActionsForStep(a,[this.element],b,c,d,e,f.scriptSet);this.generateActionsForStep(a,this.barDivs,b,c,d,e,f.barsScriptSet,this.afterBarCssProperties.bind(this))};a.prototype.afterBarCssProperties=function(a,b,c){var d=this;0>=this.domain||b.forEach(function(a,b){var c=e.convertToNumber(a.element.proCache.data[0],d.domainBase),f=e.convertToNumber(a.element.proCache.data[1],d.domainBase);console.log(a.element.proCache,c,f);var r=(d.maxDomain-Math.max(c,
f))/d.domain*d.height,c=(d.maxDomain-Math.min(c,f))/d.domain*d.height-r,f=d.barWidth/8;a.attr={x:d.margin/2+b*(d.margin+d.barWidth),width:d.barWidth,y:r,height:c,rx:f,ry:f}})};return a}(d.Motion.Render.Items.Item);b.Renderer=f})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(b.Extensions||(b.Extensions={}))})(d.Motion||(d.Motion={}))})(Pro||(Pro={}));
(function(d){(function(b){(function(b){(function(b){(function(b){var e=d.Motion.Serialization,f=d.Motion.Util;b.readJson=function(c,a){var d=Math.max(1,Math.min(f.convertToNumber(f.getSetup(a,"bars")),100)),k=Math.max(0,f.convertToNumber(f.getSetup(a,"width"),50)),v=Math.max(0,f.convertToNumber(f.getSetup(a,"height"),50)),g=Math.max(0,f.convertToNumber(f.getSetup(a,"margin"),1)),l=0,m=0,h=f.getSetup(a,"domain");"number"===typeof h?m=h:h instanceof Array&&(l=0<h.length?f.convertToNumber(h[0]):0,m=
1<h.length?f.convertToNumber(h[1]):0);m<l&&(h=m,m=l,l=h);var n=b.Props.getPropertyTypes(),p=b.Props.getBarPropertyTypes(),h=e.PropertyListReader.read(c.story,a.init,n),q=e.PropertyListReader.read(c.story,a.barInit||a.barsInit,p),n=e.ScriptSetReader.readJson(c,"Chart",a,[""],n),p=e.ScriptSetReader.readJson(c,"Bars",a,["bar","bars"],p);return new b.Extension(c,d,k,v,g,l,m,h,n,q,p)}})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(b.Extensions||(b.Extensions={}))})(d.Motion||(d.Motion=
{}))})(Pro||(Pro={}));
